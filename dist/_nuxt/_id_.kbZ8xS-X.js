var te=Object.defineProperty;var oe=(n,e,c)=>e in n?te(n,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[e]=c;var T=(n,e,c)=>(oe(n,typeof e!="symbol"?e+"":e,c),c);import{D as q,n as X,o as Y,p as se,q as ne,U as ae,s as le,_ as ie,t as re,v as ce}from"./user-store.aO2iQi_j.js";import{q as ue,r as E,s as U,h as C,l as de,k as me,j as fe,M as _e,a4 as ve,u as O,v as he,K as ge,ak as D,a1 as H,al as z,L as Q,am as J,W as pe,a5 as be,n as ye,ab as Z,o as w,ac as F,w as v,b as _,a as r,t as y,ad as xe,af as W,ae as Se,ag as B,c as R,ai as K,aj as G,ah as we}from"./entry.fjVmsYHg.js";const{passive:b}=ge,qe=ue({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:{default:void 0},initialIndex:Number,disable:Boolean,reverse:Boolean},emits:["load"],setup(n,{slots:e,emit:c}){const u=E(!1),a=E(!0),d=E(null),g=E(null);let p=n.initialIndex||0,t,o;const P=U(()=>"q-infinite-scroll__loading"+(u.value===!0?"":" invisible"));function h(){if(n.disable===!0||u.value===!0||a.value===!1)return;const s=D(t),m=H(t),N=z(t);n.reverse===!1?Math.round(m+N+n.offset)>=Math.round(s)&&I():Math.round(m)<=n.offset&&I()}function I(){if(n.disable===!0||u.value===!0||a.value===!1)return;p++,u.value=!0;const s=D(t);c("load",p,m=>{a.value===!0&&(u.value=!1,Q(()=>{if(n.reverse===!0){const N=D(t),j=H(t),ee=N-s;J(t,j+ee)}m===!0?l():d.value&&d.value.closest("body")&&o()}))})}function A(){p=0}function i(){a.value===!1&&(a.value=!0,t.addEventListener("scroll",o,b)),h()}function l(){a.value===!0&&(a.value=!1,u.value=!1,t.removeEventListener("scroll",o,b),o!==void 0&&o.cancel!==void 0&&o.cancel())}function f(){if(t&&a.value===!0&&t.removeEventListener("scroll",o,b),t=pe(d.value,n.scrollTarget),a.value===!0){if(t.addEventListener("scroll",o,b),n.reverse===!0){const s=D(t),m=z(t);J(t,s-m)}h()}}function x(s){p=s}function V(s){s=parseInt(s,10);const m=o;o=s<=0?h:be(h,isNaN(s)===!0?100:s),t&&a.value===!0&&(m!==void 0&&t.removeEventListener("scroll",m,b),t.addEventListener("scroll",o,b))}function L(s){if(S.value===!0){if(g.value===null){s!==!0&&Q(()=>{L(!0)});return}const m=`${u.value===!0?"un":""}pauseAnimations`;Array.from(g.value.getElementsByTagName("svg")).forEach(N=>{N[m]()})}}const S=U(()=>n.disable!==!0&&a.value===!0);C([u,S],()=>{L()}),C(()=>n.disable,s=>{s===!0?l():i()}),C(()=>n.reverse,()=>{u.value===!1&&a.value===!0&&h()}),C(()=>n.scrollTarget,f),C(()=>n.debounce,V);let k=!1;de(()=>{k!==!1&&t&&J(t,k)}),me(()=>{k=t?H(t):!1}),fe(()=>{a.value===!0&&t.removeEventListener("scroll",o,b)}),_e(()=>{V(n.debounce),f(),u.value===!1&&L()});const M=ye();return Object.assign(M.proxy,{poll:()=>{o!==void 0&&o()},trigger:I,stop:l,reset:A,resume:i,setIndex:x,updateScrollTarget:f}),()=>{const s=ve(e.default,[]);return S.value===!0&&s[n.reverse===!1?"push":"unshift"](O("div",{ref:g,class:P.value},he(e.loading))),O("div",{class:"q-infinite-scroll",ref:d},s)}}});class ${constructor(e){T(this,"id");T(this,"name");T(this,"email");T(this,"body");this.id=e.id,this.name=e.name,this.email=e.email,this.body=e.body}static fromJson(e){return new $({id:q.integer(e==null?void 0:e.id),name:q.string(e==null?void 0:e.name),email:q.string(e==null?void 0:e.email),body:q.string(e==null?void 0:e.body)})}toJson(){return{id:this.id,name:this.name,email:this.email,body:this.body}}}const Ie={class:"text-body text-weight-bold"},Le={class:"text-body text-grey"},ke={class:"text-body2"},Ne=Z({__name:"post-comment",props:{comment:{type:Object,default:()=>$.fromJson()}},setup(n){const e=n;return(c,u)=>{const a=X,d=Y;return w(),F(d,{class:"post-comment"},{default:v(()=>[_(a,null,{default:v(()=>[r("div",Ie,y(e.comment.name),1),r("div",Le,y(e.comment.email),1)]),_:1}),_(a,{class:"q-pt-none"},{default:v(()=>[r("div",ke,y(e.comment.body),1)]),_:1})]),_:1})}}}),Te={class:"post-details"},Ce={class:"text-h3"},Be={class:"text-subtitle text-weight-bold"},Ee={class:"text-subtitle text-grey"},Pe={class:"row q-my-md"},Ve=r("div",{class:"col-12 col-sm-6"},[r("div",{class:"text-h5"},"Comments")],-1),De={class:"col-12 col-sm-6"},Ue={key:0},$e={class:"post-details__comments"},Ae={class:"row justify-center q-my-md"},Re=Z({__name:"[id]",async setup(n){let e,c;const u=xe(),a=E(),d=se(),g=ne(),p=U(()=>{var l;const i=Number.parseInt(((l=u.currentRoute.value.params.id)==null?void 0:l.toString())??"");return Number.isInteger(i)?i:1});[e,c]=W(()=>d.fetchDetails(p.value)),await e,c(),g.list.length===0&&([e,c]=W(()=>g.fetchList()),await e,c());const t=U(()=>g.list.find(l=>l.id===d.post.userId)??ae.fromJson()),o=Se({comments:[],timeoutId:0,input:"",loading:!1}),P=async i=>{const l=await $fetch(`https://jsonplaceholder.typicode.com/posts/${p.value}/comments`,{query:{name_like:i||void 0}}).catch(f=>{console.warn("Failed to load comments",q.string(f))});return Promise.resolve(l)},h=i=>{o.comments=q.list(i).map(l=>$.fromJson(l))},I=async(i,l)=>{const f=await P();setTimeout(()=>{var x;h(f),l(),(x=a.value)==null||x.stop()},2e3)},A=()=>{o.timeoutId!==0&&window.clearTimeout(o.timeoutId),o.timeoutId=window.setTimeout(async()=>{o.loading=!0;const i=await P(o.input);o.loading=!1,h(i)},1e3)};return(i,l)=>{const f=X,x=Y,V=ie,L=Ne,S=re,k=ce,M=le;return w(),F(M,null,{default:v(()=>[r("div",Te,[_(x,{flat:"",bordered:""},{default:v(()=>[_(f,null,{default:v(()=>[r("div",Ce,y(B(d).post.title),1),r("div",Be,y(B(t).name),1),r("div",Ee,y(B(t).email),1)]),_:1}),_(f,{class:"q-pt-none"},{default:v(()=>[(w(),R(G,null,K(20,s=>r("p",{key:s},y(B(d).post.body),1)),64))]),_:1})]),_:1}),r("div",Pe,[Ve,r("div",De,[_(V,{dense:"",outlined:"",label:"Search By User",modelValue:o.input,"onUpdate:modelValue":[l[0]||(l[0]=s=>o.input=s),A]},null,8,["modelValue"])])]),o.comments.length===0?(w(),R("span",Ue," No comments so far ")):we("",!0),r("div",$e,[(w(!0),R(G,null,K(o.comments,s=>(w(),F(L,{class:"q-mb-md",key:s.id,comment:s},null,8,["comment"]))),128)),_(k,{showing:o.loading},{default:v(()=>[_(S,{size:"50px",color:"primary"})]),_:1},8,["showing"]),_(B(qe),{ref_key:"commentScroll",ref:a,onLoad:I,offset:50},{loading:v(()=>[r("div",Ae,[_(S,{size:"50px",color:"primary"})])]),_:1},512)])])]),_:1})}}});export{Re as default};
